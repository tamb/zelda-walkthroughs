const CACHE_NAME="zelda-walkthroughs-v3-alpha2",CACHE_VERSION="1.0.0-alpha.2",getAssetPrefix=()=>{let e=location.pathname.match(/^(\/[^\/]+)\//);return e?e[1]:""},assetPrefix=getAssetPrefix(),SW_SCOPE=assetPrefix||"/",urlsToCache=[`${assetPrefix}/`,`${assetPrefix}/manifest.json`,`${assetPrefix}/icons/icon-192x192.svg`,`${assetPrefix}/icons/icon-512x512.svg`];self.addEventListener("install",e=>{console.log("Service Worker installing...",CACHE_VERSION),e.waitUntil(caches.open(CACHE_NAME).then(e=>(console.log("Opened cache",CACHE_NAME),e.addAll(urlsToCache).catch(e=>(console.warn("Failed to cache some resources:",e),Promise.resolve()))))),self.skipWaiting()}),self.addEventListener("fetch",e=>{e.respondWith(fetch(e.request).then(s=>{if(!s||200!==s.status||"basic"!==s.type)return s;let t=s.clone();return caches.open(CACHE_NAME).then(s=>{s.put(e.request,t)}),s}).catch(()=>caches.match(e.request).then(s=>s||("document"===e.request.destination?caches.match(`${assetPrefix}/`):new Response("Offline",{status:503,statusText:"Service Unavailable"})))))}),self.addEventListener("activate",e=>{console.log("Service Worker activating...",CACHE_VERSION),e.waitUntil(caches.keys().then(e=>(console.log("Found caches:",e),Promise.all(e.map(e=>{if(e!==CACHE_NAME)return console.log("Deleting old cache:",e),caches.delete(e)})))).then(()=>(console.log("Cache cleanup complete, taking control..."),self.clients.claim())).then(()=>self.clients.matchAll().then(e=>{e.forEach(e=>{e.postMessage({type:"SW_UPDATED",version:CACHE_VERSION})})})))}),self.addEventListener("message",e=>{e.data&&"SKIP_WAITING"===e.data.type&&self.skipWaiting()});